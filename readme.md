# üèãÔ∏è‚Äç‚ôÄÔ∏è‚ÄØSport¬†Platform¬†‚Äî¬†Mono‚ÄëRepo

–ï–¥–∏–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ¬†–≤—Å–µ–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞: –±–∞–∑–∞‚ÄØ–¥–∞–Ω–Ω—ã—Ö, –º–∏–≥—Ä–∞—Ü–∏–∏, —Å–µ—Ä–≤–∏—Å—ã –Ω–∞¬†Java, Swift –∏¬†–¥—Ä.¬†–í—Å—ë —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏¬†–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π `docker compose`¬†‚Äî –Ω–∏–∫–∞–∫–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ SDK —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–µ¬†–Ω—É–∂–Ω–æ.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–∫–∞—Ç–∞–ª–æ–≥–∞)
2. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (TL;DR)](#–ø–µ—Ä–≤—ã–π-–∑–∞–ø—É—Å–∫-tldr)
4. [–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π workflow](#–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π-workflow)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏¬†–º–∏–≥—Ä–∞—Ü–∏–∏](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–º–∏–≥—Ä–∞—Ü–∏–∏)
6. [–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å](#–∫–∞–∫-–¥–æ–±–∞–≤–∏—Ç—å-—Å–≤–æ–π-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å)
7. [–ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–æ–ª—å–∫–æ-–Ω—É–∂–Ω—ã—Ö-—Å–µ—Ä–≤–∏—Å–æ–≤)
8. [–°–±—Ä–æ—Å¬†/ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞](#—Å–±—Ä–æ—Å--–ø–æ–ª–Ω–∞—è-–æ—á–∏—Å—Ç–∫–∞)
9. [–¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏](#—Ç–∏–ø–æ–≤—ã–µ-–æ—à–∏–±–∫–∏)
10. [FAQ](#faq)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

```
repo-root/
‚îú‚îÄ infra/                     # –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏¬†CI
‚îÇ  ‚îú‚îÄ docker-compose.yml      # –æ–±—â–∏–π —Å—Ç–µ–∫
‚îÇ  ‚îî‚îÄ db/
‚îÇ¬†¬†¬†¬† ‚îú‚îÄ init/01_roles.sql    # —Ä–æ–ª–∏ + –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ (user/password)
‚îÇ¬†¬†¬†¬† ‚îî‚îÄ migration/           # V1__, V2__, ‚Ä¶ (Flyway)
‚îÇ
‚îú‚îÄ svc-user/   #!!!–ü–†–ò–ú–ï–† –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞¬†Java¬†/ Spring Boot
‚îÇ¬†¬†‚îú‚îÄ Dockerfile
‚îÇ¬†¬†‚îú‚îÄ pom.xml
‚îÇ¬†¬†‚îî‚îÄ src/‚Ä¶
‚îÇ
‚îú‚îÄ svc-notify/                # –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞¬†Swift (–ø—Ä–∏–º–µ—Ä)
‚îÇ¬†¬†‚îú‚îÄ Dockerfile
‚îÇ¬†¬†‚îî‚îÄ Sources/‚Ä¶
‚îî‚îÄ ‚Ä¶                          # –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏ —Å–µ—Ä–≤–∏—Å—ã –≤¬†–∫–æ—Ä–µ–Ω—å
```

### –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏

- **–ü–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:** `8080`\
  –ù–∞ —Ö–æ—Å—Ç –º–∞–ø–ø–∏–º —Å–≤–æ–±–æ–¥–Ω—ã–π (`8081`, `8082`¬†‚Ä¶) —á–µ—Ä–µ–∑ `ports: "HOST:8080"`.
- **Creds –ë–î –ø–æ¬†—É–º–æ–ª—á–∞–Ω–∏—é:** `user / password`¬†‚Äî —Å–º. —Å–∫—Ä–∏–ø—Ç `01_roles.sql`.
- **JAR‚Äë—Ñ–∞–π–ª Java‚Äë—Å–µ—Ä–≤–∏—Å–æ–≤:** –≤—Å–µ–≥–¥–∞ `target/app.jar` (—Ä–µ—à–∞–µ—Ç—Å—è `<finalName>app</finalName>` + goal¬†`repackage`).

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ß—Ç–æ                        | –í–µ—Ä—Å–∏—è     | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                       |
| -------------------------- | ---------- | --------------------------------- |
| **Docker¬†Desktop**         | ‚â•¬†4.25     | —Å–æ–¥–µ—Ä–∂–∏—Ç `docker compose`         |
| **Git**                    | –ª—é–±–∞—è      |                                   |
| **JDK / Swift / Node / ‚Ä¶** | *–Ω–µ –Ω—É–∂–Ω—ã* | –≤—Å—ë —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |

---

## –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (TL;DR)

```bash
# –∫–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ
$ git clone <repo-url> && cd repo-root

# 1¬†‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö + –º–∏–≥—Ä–∞—Ü–∏–∏
$ docker compose -f infra/docker-compose.yml up -d postgres flyway

# 2¬†‚Äî –Ω—É–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å (–ø—Ä–∏–º–µ—Ä: Java‚Äësvc)
$ docker compose -f infra/docker-compose.yml up -d svc-user

# 3¬†‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º
$ curl http://localhost:8081/api/db-check
# {"status":"UP", ‚Ä¶}
```

> **–í–∞–∂–Ω–æ:** –µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç–µ SQL‚Äë–º–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ —Ä–æ–ª–∏, —É–¥–∞–ª—è–π—Ç–µ —Ç–æ–º `pgdata`:\
> `docker compose -f infra/docker-compose.yml down -v`

---

## –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π¬†workflow

| –ó–∞–¥–∞—á–∞                        | –ö–æ–º–∞–Ω–¥–∞                                                                                                                |
| ----------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å–≤–æ–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞  | `docker compose -f infra/docker-compose.yml build svc-user`                                                            |
| –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î¬†(—á–∏—Å—Ç–∞—è —Å—Ö–µ–º–∞) | `docker compose -f infra/docker-compose.yml down -v``docker compose -f infra/docker-compose.yml up -d postgres flyway` |
| –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å—Ç–µ–∫           | `docker compose -f infra/docker-compose.yml up -d`                                                                     |
| –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞                  | `docker compose -f infra/docker-compose.yml logs -f svc-user`                                                          |
| –°—Ç–æ–ø –≤—Å–µ–≥–æ                    | `docker compose -f infra/docker-compose.yml down`                                                                      |

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏¬†–º–∏–≥—Ä–∞—Ü–∏–∏

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: ``
- –†–æ–ª—å/–ø–∞—Ä–æ–ª—å —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å—Ç–∞—Ä—Ç–µ —Å–∫—Ä–∏–ø—Ç–æ–º `init/01_roles.sql`.
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ª–µ–∂–∞—Ç –≤¬†`infra/db/migration/` –∏¬†–∏–º–µ–Ω—É—é—Ç—Å—è:
  ```
  V1__init_schema.sql
  V2__add_payments_table.sql
  ```
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö job‚Äë–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Flyway:
  ```yaml
  flyway:
    image: flyway/flyway:10-alpine
    volumes: [ "./db/migration:/flyway/sql:ro" ]
    environment:
      FLYWAY_URL:  jdbc:postgresql://postgres:5432/sport
      FLYWAY_USER: user
      FLYWAY_PASSWORD: password
    command: migrate
  ```

---

## –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å

1. **–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥** –≤¬†–∫–æ—Ä–Ω–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä¬†`svc-payments/`.
2. **Dockerfile**: —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç (jar, –±–∏–Ω–∞—Ä—å) *–≤–Ω—É—Ç—Ä–∏* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
3. **–°–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç¬†**`` (–∏–Ω–∞—á–µ –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å healthcheck).
4. **–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é** –≤¬†`infra/docker-compose.yml`:
   ```yaml
   payments:
     build: ../svc-payments         # –ø—É—Ç—å –æ—Ç infra/
     depends_on:
       flyway:
         condition: service_completed_successfully
     environment:
       DB_URL:  jdbc:postgresql://postgres:5432/sport
       DB_USER: user
       DB_PASS: password
     ports: [ "8083:8080" ]
   ```
5. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏:** –¥–æ–±–∞–≤—å—Ç–µ `V__*.sql` –≤¬†`infra/db/migration/`.
6. `docker compose -f infra/docker-compose.yml build payments && \ docker compose -f infra/docker-compose.yml up -d payments`

---

## –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ë–î + –º–∏–≥—Ä–∞—Ü–∏–∏ + –¥–≤–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞
$ docker compose -f infra/docker-compose.yml up -d postgres flyway svc-user svc-notify
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≥–æ–Ω—è—Ç—å –æ–¥–∏–Ω –∏¬†—Ç–æ—Ç¬†–∂–µ –Ω–∞–±–æ—Ä¬†‚Äî —Å–æ–∑–¥–∞–π—Ç–µ `docker-compose.override.yml` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∏.

---

## –°–±—Ä–æ—Å¬†/ –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

```bash
# –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏¬†—É–¥–∞–ª—è–µ–º –í–°–Å (+ volume —Å¬†–¥–∞–Ω–Ω—ã–º–∏ –ë–î)
$ docker compose -f infra/docker-compose.yml down -v

# –ø–æ–¥–Ω–∏–º–∞–µ–º —Å¬†—á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞
$ docker compose -f infra/docker-compose.yml up -d postgres flyway svc-user
```

---

## –¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏

| –°–∏–º–ø—Ç–æ–º                                          | –ü—Ä–∏—á–∏–Ω–∞                         | –†–µ—à–µ–Ω–∏–µ                                                                                                                      |
| ------------------------------------------------ | ------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `no main manifest attribute`                     | JAR —Å–æ–±—Ä–∞–Ω –±–µ–∑ goal `repackage` | –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤¬†`pom.xml` —É¬†–ø–ª–∞–≥–∏–Ω–∞ Spring Boot –ø—Ä–æ–ø–∏—Å–∞–Ω `<mainClass>` –∏¬†goal¬†`repackage`; –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ `--no-cache`. |
| `password authentication failed for user "user"` | –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å                 | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DB_USER/PASS` –≤¬†compose –∏¬†—Å–∫—Ä–∏–ø—Ç–µ¬†`01_roles.sql`; –∑–∞—Ç–µ–º `down -v`.                                                |
| `relation "table" does not exist`                | —Å–µ—Ä–≤–∏—Å —Å—Ç–∞—Ä—Ç—É–µ—Ç —Ä–∞–Ω—å—à–µ –º–∏–≥—Ä–∞—Ü–∏–π | –í —Å–µ–∫—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞¬†‚Üí `depends_on: flyway: condition: service_completed_successfully`.                                          |
| –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç                                       | –ù–∞¬†—Ö–æ—Å—Ç–µ —Ç–æ—Ç¬†–∂–µ –ø–æ—Ä—Ç            | –ü–æ–º–µ–Ω—è–π—Ç–µ –ª–µ–≤—É—é —á–∞—Å—Ç—å –≤¬†`"8085:8080"`.                                                                                       |

---

## FAQ

**Q:** *–ù—É–∂–Ω–æ –ª–∏ —Å—Ç–∞–≤–∏—Ç—å JDK, Swift, Node‚Ä¶?*\
**A:** –ù–µ—Ç. –í—Å—ë –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

**Q:** *–ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫—Ä–µ–¥—ã –≤–º–µ—Å—Ç–æ user/password?*\
**A:** –î–∞. –ò–∑–º–µ–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç `01_roles.sql` –∏¬†–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∑–∞—Ç–µ–º `down -v`.

**Q:** *–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π hot‚Äëreload?*\
**A:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞ (Docker¬†Desktop ‚Üí Settings¬†‚Üí Resources¬†‚Üí File¬†Sharing) –∏¬†spring‚Äëdev‚Äëtools / nodemon –≤–Ω—É—Ç—Ä–∏ Dockerfile.

---

